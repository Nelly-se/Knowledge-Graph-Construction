# ğŸ“ 02/16 ä¼˜åŒ–å·¥ä½œæ€»ç»“  

**é¡¹ç›®åç§°**: æ³°åº·åŒ»å…»çŸ¥è¯†å›¾è°±æ™ºèƒ½é—®ç­”ç³»ç»Ÿ (Insurance-Medical-KGQA)

**æ›´æ–°æ—¶é—´**: 2026-02-16

**ä¸»è¦å†…å®¹**: æ¶æ„é‡æ„ã€æ£€ç´¢ç­–ç•¥ä¼˜åŒ–ã€å¤šè½®å¯¹è¯å®ç°ã€UI è§†è§‰å‡çº§ã€éç»“æ„åŒ–æ•°æ®æŠ½å–ã€‚

------

## 1. æ ¸å¿ƒæ£€ç´¢ç­–ç•¥ä¼˜åŒ– (Retrieval Optimization)

è§£å†³äº†æ—©æœŸç‰ˆæœ¬ä¸­æ£€ç´¢ç»“æœå•ä¸€ã€çƒ­é—¨äº§å“ï¼ˆå¦‚â€œè“åŒ»ä¿â€ï¼‰éœ¸å±ä»¥åŠé•¿æ–‡æœ¬æˆªæ–­çš„é—®é¢˜ã€‚

- **å¼•å…¥â€œéšæœºæ´—ç‰Œâ€æœºåˆ¶**ï¼š
  - åœ¨ `graph_retriever.py` çš„é€šç”¨æŸ¥è¯¢ä¸­å¢åŠ äº† `ORDER BY rand()`ï¼Œè§£å†³äº†æ¯æ¬¡åªè¿”å›å›ºå®šå‰å‡ æ¡æ•°æ®ï¼ˆé€šå¸¸æ˜¯åŒä¸€ç³»åˆ—äº§å“ï¼‰çš„é—®é¢˜ï¼Œä¿è¯äº†æ¨èçš„å¤šæ ·æ€§ã€‚
- **å®ç°â€œæ··åˆæ£€ç´¢ç­–ç•¥â€ (Hybrid Search)**ï¼š
  - **é€šç”¨æ£€ç´¢**ï¼šå½“ç”¨æˆ·æ¨¡ç³Šæé—®ï¼ˆå¦‚â€œæ¨èä¸ªä¿é™©â€ï¼‰æ—¶ï¼Œæ‰§è¡Œéšæœºæ’åº + è¾ƒä½çš„ `LIMIT`ã€‚
  - **ç²¾å‡†ç‹™å‡»**ï¼šå½“æ£€æµ‹åˆ°ç‰¹å®šäº§å“ç³»åˆ—å…³é”®è¯ï¼ˆå¦‚â€œè“åŒ»ä¿â€ã€â€œå¥½åŒ»ä¿â€ï¼‰æ—¶ï¼Œç§»é™¤éšæœºæ’åºï¼Œæ‰§è¡Œ `CONTAINS` ç²¾å‡†åŒ¹é…ï¼Œå¹¶é€‚å½“è°ƒå¤§ `LIMIT`ï¼Œç¡®ä¿è¯¥ç³»åˆ—äº§å“å…¨é‡å¬å›ã€‚
- **è§£å†³ Output Token æˆªæ–­**ï¼š
  - è°ƒæ•´äº† Neo4j çš„æ£€ç´¢ `LIMIT`ï¼ˆå»ºè®® 6-12 æ¡ï¼‰ï¼Œå¹¶åœ¨ `llm_integration.py` ä¸­æ˜¾å¼å¢åŠ äº† `max_tokens=4096` å‚æ•°ï¼Œé˜²æ­¢å¤§æ¨¡å‹åœ¨ä»‹ç»å¤šä¸ªäº§å“æ—¶å›ç­”ä¸­æ–­ã€‚

## 2. å¤šè½®å¯¹è¯ä¸æ„å›¾ç†è§£ (Multi-turn Conversation)

å®ç°äº†ç±»ä¼¼ ChatGPT çš„ä¸Šä¸‹æ–‡è®°å¿†åŠŸèƒ½ï¼Œä½¿ AI èƒ½å¤Ÿå¤„ç†â€œä»£è¯æŒ‡ä»£â€å’Œâ€œè¿½é—®â€ã€‚

- **åç«¯ API æ”¹é€ **ï¼š
  - ä¿®æ”¹ `main.py` å’Œ `rag_engine.py`ï¼Œæ¥å£æ–°å¢ `history` å­—æ®µï¼Œæ”¯æŒå‰ç«¯ä¼ é€’å†å²å¯¹è¯åˆ—è¡¨ã€‚
- **æŒ‡ä»£æ¶ˆè§£ (Coreference Resolution)**ï¼š
  - å¼•å…¥ **Query Rewriting (é—®é¢˜é‡å†™)** æ¨¡å—ã€‚åœ¨æ£€ç´¢å‰ï¼Œåˆ©ç”¨ LLM å°†â€œå®ƒå¤šå°‘é’±ï¼Ÿâ€ç»“åˆå†å²é‡å†™ä¸ºâ€œè“åŒ»ä¿é•¿æœŸåŒ»ç–—é™©å¤šå°‘é’±ï¼Ÿâ€ï¼Œç¡®ä¿æ£€ç´¢å‡†ç¡®æ€§ã€‚
- **é€»è¾‘é” (Logical Locking)**ï¼š
  - åœ¨ System Prompt ä¸­å¢åŠ äº†**å¼ºçº¦æŸæŒ‡ä»¤**ã€‚å½“æ£€æµ‹åˆ°â€œä¸Šé¢çš„â€ã€â€œåˆšæ‰æåˆ°çš„â€ç­‰è¯æ±‡æ—¶ï¼Œå¼ºåˆ¶ AI **ä»…**ä»å†å²è®°å½• (`history_content`) ä¸­æå–ç­”æ¡ˆï¼Œç‰©ç†å±è”½æ–°ä¸€è½®æ£€ç´¢å¸¦æ¥çš„å¹²æ‰°æ•°æ®ï¼Œå½»åº•è§£å†³äº†â€œç­”éæ‰€é—®â€å’Œâ€œæ–°æ—§æ•°æ®æ··æ·†â€çš„é—®é¢˜ã€‚



## 3. å·¥ç¨‹åŒ–ä¸å®‰å…¨è§„èŒƒ (Engineering & DevOps)

å°†é¡¹ç›®ä»â€œä¸ªäººç»ƒä¹ ä»£ç â€æå‡è‡³â€œå›¢é˜Ÿåä½œæ ‡å‡†â€ã€‚

- **æ•æ„Ÿä¿¡æ¯åˆ†ç¦»**ï¼š
  - åˆ›å»º `.env` æ–‡ä»¶ç®¡ç† `NEO4J_PASSWORD` å’Œ `DASHSCOPE_API_KEY`ã€‚
  - ä¿®æ”¹ `config.yaml` ä»…ä¿ç•™éæ•æ„Ÿé…ç½®ã€‚
- **Git è§„èŒƒåŒ–ç®¡ç†**ï¼š
  - é…ç½®äº†æ ‡å‡†çš„ `.gitignore`ï¼Œå¿½ç•¥äº† `.env`ã€`__pycache__/`ã€`venv/`ã€`.DS_Store` ç­‰åƒåœ¾æ–‡ä»¶æˆ–æ•æ„Ÿæ–‡ä»¶ã€‚
  - æ¸…ç†äº† Git å†å²ä¸­é”™è¯¯è¿½è¸ªçš„ `.pyc` å­—èŠ‚ç æ–‡ä»¶ï¼Œä¿æŒä»“åº“çº¯å‡€ã€‚
- **ç¯å¢ƒéš”ç¦»**ï¼š
  - æ˜ç¡®äº†è™šæ‹Ÿç¯å¢ƒ (`venv`) çš„ä½¿ç”¨å¿…è¦æ€§ï¼Œé¿å…å…¨å±€ä¾èµ–å†²çªã€‚

## 4. æ–°åŠŸèƒ½ï¼šéç»“æ„åŒ–æ–‡æœ¬æŠ½å– (LLM-IE)

ä¸ºäº†æ‰©å±•çŸ¥è¯†å›¾è°±çš„æ•°æ®æ¥æºï¼Œå®ç°äº†åŸºäº LLM çš„ä¿¡æ¯æŠ½å–åŠŸèƒ½ã€‚

- **æ–°å¢ Pipeline**ï¼š
  - åˆ›å»º `src/kg_construction/text_graph_builder.py`ã€‚
- **åŠŸèƒ½å®ç°**ï¼š
  - å®ç°äº†è¯»å–åŸå§‹ä¿é™©æ¡æ¬¾ (`.txt`) -> Prompt å¼•å¯¼ LLM æå–å®ä½“å…³ç³» (JSON) -> è‡ªåŠ¨å†™å…¥ Neo4j çš„å…¨æµç¨‹ã€‚
  - æ”¯æŒæå– `Insurance` (ä¿é™©)ã€`Disease` (ç–¾ç—…)ã€`AgeRange` (å¹´é¾„èŒƒå›´) ç­‰å®ä½“åŠå…¶ `COVERS` (è¦†ç›–)ã€`REFUSES` (æ‹’ä¿) ç­‰å…³ç³»ã€‚

------

## ğŸ“‚ å½“å‰é¡¹ç›®ç›®å½•å¿«ç…§

Plaintext

```
insurance_medical_kgqa/
â”œâ”€â”€ .env                  # [ç§å¯†] å¯†é’¥æ–‡ä»¶
â”œâ”€â”€ .gitignore            # [é…ç½®] Gitå¿½ç•¥è§„åˆ™
â”œâ”€â”€ config.yaml           # [é…ç½®] å…¬å…±å‚æ•°
â”œâ”€â”€ requirements.txt      # ä¾èµ–åŒ…åˆ—è¡¨
â”‚
â”œâ”€â”€ data/                 # [æ•°æ®]
â”‚   â””â”€â”€ raw_text/         # [æ–°å¢] å­˜æ”¾ä¿é™©æ¡æ¬¾ TXT
â”‚       â””â”€â”€ sample_policy.txt
â”‚
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ streamlit_app.py  # [å‰ç«¯] UI é€»è¾‘ (Markdownç‰ˆ)
â”‚
â””â”€â”€ src/
    â”œâ”€â”€ api/
    â”‚   â””â”€â”€ main.py       # [åç«¯] FastAPI (æ”¯æŒ history)
    â”‚
    â”œâ”€â”€ graph_rag/
    â”‚   â”œâ”€â”€ graph_retriever.py    # [æ ¸å¿ƒ] æ£€ç´¢å™¨ (å«ç²¾å‡†/æ¨¡ç³Šæ··åˆç­–ç•¥)
    â”‚   â”œâ”€â”€ rag_engine.py         # [æ ¸å¿ƒ] é—®ç­”å¼•æ“ (å«é‡å†™ä¸é€»è¾‘é”)
    â”‚   â”œâ”€â”€ llm_integration.py    # [æ¨¡å‹] å¢åŠ  max_tokens å‚æ•°
    â”‚   â””â”€â”€ query_understanding.py
    â”‚
    â””â”€â”€ kg_construction/
        â”œâ”€â”€ neo4j_loader.py       # ç»“æ„åŒ–æ•°æ®å¯¼å…¥
        â””â”€â”€ text_graph_builder.py # [æ–°å¢] éç»“æ„åŒ–æ–‡æœ¬æŠ½å–è„šæœ¬
```

------

## ğŸ“… ä¸‹ä¸€æ­¥è®¡åˆ’ (Next Steps)

1. **å®ä½“å¯¹é½ (Entity Alignment)**ï¼šè§£å†³ LLM æŠ½å–çš„â€œæ¶æ€§è‚¿ç˜¤-é‡åº¦â€ä¸åº“ä¸­â€œæ¶æ€§è‚¿ç˜¤â€ä¸åŒ¹é…çš„é—®é¢˜ã€‚
2. **å‘é‡æ£€ç´¢ (Vector Search)**ï¼šå¼•å…¥å‘é‡æ•°æ®åº“ï¼Œå¼¥è¡¥å…³é”®è¯åŒ¹é…åœ¨è¯­ä¹‰ç†è§£ä¸Šçš„ä¸è¶³ï¼ˆå¦‚ç”¨æˆ·æœâ€œå¤§ç—…é™©â€èƒ½åŒ¹é…åˆ°â€œé‡ç–¾é™©â€ï¼‰ã€‚
3. **å‰ç«¯ä½“éªŒ**ï¼šåœ¨ Markdown åŸºç¡€ä¸Šï¼Œå¢åŠ æ›´ä¸°å¯Œçš„ Streamlit ç»„ä»¶ï¼ˆå¦‚ç‚¹å‡»å¤åˆ¶ã€åé¦ˆæŒ‰é’®ï¼‰ã€‚