# 项目初始概览

## 1. 项目介绍
本项目是一个**保险+医养知识图谱问答系统**，旨在整合保险、医疗、养老三大领域的知识，基于 GraphRAG（Graph Retrieval-Augmented Generation）技术，支持用户使用自然语言提问，并结合知识图谱与大模型生成准确、专业的回答。

## 2. 技术架构

| 层级 | 技术栈 | 说明 |
|------|--------|------|
| **知识图谱** | Neo4j + Py2neo | 用于存储和检索结构化知识（实体、关系） |
| **大模型** | 阿里云百炼 API / 本地 Qwen | 负责理解用户意图并基于检索到的图谱知识生成回答 |
| **后端** | FastAPI | 提供问答、健康检查等 API 接口 |
| **前端** | Streamlit | 提供交互式的问答界面 |
| **配置管理** | YAML | 统一管理数据库连接、模型参数等配置 |

## 3. 目录结构说明

项目根目录主要包含以下内容：

- **`insurance_medical_kgqa/`**: 核心代码目录
    - **`src/`**: 源代码
        - `kg_construction/`: 知识图谱构建模块（数据收集、实体抽取、入库）
        - `graph_rag/`: 问答引擎模块（查询理解、图检索、Prompt构建、LLM调用）
        - `api/`: 后端接口服务
        - `utils/`: 通用工具（配置加载、日志等）
    - **`data/`**: 数据存放目录（含 raw, processed, knowledge_base）
    - **`frontend/`**: 前端应用代码
    - **`docs/`**: 开发文档
    - `config.yaml`: 项目主配置文件
- **`DataCleaned/`**: 清洗后的原始数据备份
    - `中老年疾病目录/`: 疾病相关数据
    - `养老机构数据/`: 养老院相关数据
    - `医保药品目录/`: 药品相关数据
    - `医疗保险数据/`: 保险产品相关数据
- **`Documents/`**: 项目文档存放目录（本文档所在位置）

## 4. 已有数据资源

项目目前已包含以下四大类核心数据：

### 4.1 中老年疾病数据
- **来源**: `DataCleaned/中老年疾病目录/diseases.json`
- **内容**: 包含常见中老年疾病的详细信息，如ICD编码、患病概率、就诊科室、并发症、常用药物、症状、治疗方案及护理建议等。

### 4.2 养老机构数据
- **来源**: `DataCleaned/养老机构数据/nursing_homes.csv` & `.json`
- **内容**: 北京地区的养老机构信息，包含机构名称、性质（民营/公建等）、床位数、月费用、特色服务（如医养结合）及详细地址。

### 4.3 医保药品目录数据
- **来源**: `DataCleaned/医保药品目录/medicine.json`
- **内容**: 包含西药、中成药等医保药品分类及具体药品信息。
- **结构**: 具有层级分类（大类-子类-药品），包含医保报销类别（甲/乙类）、剂型等详细信息。

### 4.4 医疗保险数据
- **来源**: `DataCleaned/医疗保险数据/insurance_info.json`
- **内容**: 各类商业医疗保险产品信息，包含产品名称、险种分类、承保公司、适用年龄、保障期限及价格等。

## 5. 核心模块功能

### 5.1 知识图谱构建 (`src/kg_construction`)
负责将非结构化或半结构化数据转化为图谱数据：
- **`DataCollector`**: 统一加载医疗和保险数据源。
- **`OntologyDesign`**: 定义实体类型、关系类型及属性Schema。
- **`EntityExtractor`**: 从文本或结构化记录中抽取实体和三元组。
- **`Neo4jLoader`**: 负责与Neo4j数据库交互，建立索引并批量写入数据。

### 5.2 GraphRAG 引擎 (`src/graph_rag`)
负责问答的核心逻辑：
- **`QueryUnderstanding`**: 解析用户问题，提取意图和关键实体。
- **`GraphRetriever`**: 根据提取的实体在图谱中检索相关子图（SubGraph）。
- **`PromptEngineering`**: 将检索到的图谱上下文组装成 LLM 可理解的 Prompt。
- **`LLMIntegration`**: 封装大模型调用接口，支持流式生成和多轮对话。
